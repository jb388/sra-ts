---
title: Supplemental information for Soil minerals mediate climatic control of soil C cycling on annual to centennial timescales
shorttitle: Supplemental information
author:
  - name: Jeffrey Beem-Miller
    affiliation: '1'
    address: Hans-Knoell-Str. 10, 07745 Jena, Germany
    corresponding: yes
    email: jbeem@bgc-jena.mpg.de
  - name: Craig Rasmussen
    affiliation: '2'
  - name: Alison M. Hoyt
    affiliation: '1,3'
  - name: Marion Schrumpf
    affiliation: '1'
  - name: Georg Guggenberger
    affiliation: '4'
  - name: Susan Trumbore
    affiliation: '1'
affiliation:
  - id: '1'
    institution: Department of Biogeochemical Processes, Max Planck Institute for Biogeochemistry, Jena, Germany
  - id: '2'
    institution: Department of Environmental Science, The University of Arizona, Tucson, AZ, USA
  - id: '3'
    institution: Department of Earth System Science Science, Stanford University, Stanford, CA, USA
  - id: '4'
    institution: Institute of Soil Science, Leibniz University Hannover, Hannover, Germany
output: 
  pdf_document: papaja::apa6_pdf
  word_document:
  html_document:
    df_print: paged
    toc: yes
    toc_depth: '2'
  html_notebook:
    css: "custom.css"
    toc: yes
    toc_depth: 2
figurelist: yes
floatsintext: yes
footnotelist: no
linenumbers: yes
figsintext: yes
mask: no
classoption: man
tablelist: yes
numbersections: yes
header_includes:
- \usepackage[utf8]{inputenc}
- \usepackage{float}
- \usepackage{booktabs}
- \usepackage{longtable}
---

\renewcommand{\appendixname}{Supplementary Information}
\renewcommand{\thesection}{S\arabic{section}} \setcounter{section}{0}
\renewcommand{\thefigure}{S\arabic{figure}} \setcounter{figure}{0}
\renewcommand{\thetable}{S\arabic{table}} \setcounter{table}{0}

```{r global_options, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE,
                      fig.align = 'center', dev = c('cairo_pdf', 'png'))
options(scipen = 5)
```

```{r setup, include = FALSE}
library(ggplot2)
library(dplyr)
library(tidyr)
library(SoilR)
library(readxl)
library(ISRaD)
library(emmeans)
library(gt)
library(GSIF)
library(aqp)
library(cowplot)
library(kableExtra)
library(grid)
library(gridExtra)
library(purrr)
```

```{r col-pals}
# color palettes for ECO & PM
warm <- "#BF812D"
cool <- "#80CDC1"
cold <- "#01665E"
granite <- "#9daba9"
andesite <- "#382dbf"
basalt <- "#bf382d"
```

```{r atm-14c}
load("atm.14c.RData")
atm.14c <- atm.14c %>% rename(Year = year) %>% mutate(Type = "atmosphere")
slope.atm14c.01.19 <- round(summary(lm(d14c ~ Year, atm.14c))$coef[2,1],2)
```

```{r load-min}
load("ras18.sp.df.RData")
```

```{r ingest-fxs, include=FALSE}
source("./utilities/jena_ams_ingest.R")
source("./utilities/jena_elm_ingest.R")
```

```{r emmeans-output-fxs}
# bold sig. trend function
trendCIform.fx <- function(trend, l, u) {
  cell_spec(trend, "latex", bold = ifelse(u < 0 | l > 0, TRUE, FALSE))
}

# format pvalues function
pvalForm.fx <- function(p) {
  cell_spec(ifelse(p < 0.001, "< .001", round(p, 3)),
              "latex", bold = ifelse(p > 0.05, FALSE, TRUE))
}

# sig contrasts fx
sig.cts.fx <- function(df) {
  df <- df[which(df$p.value < 0.1), ]
} 
```

# Soil carbon

```{r soil-C-stats, include = FALSE}
# reps df
load("sra.01.09.19.blkC.reps.RData")

# Conf. int excludes zero fx (returns matching data frame rows)
confint.X0.fx <- function(df, l, u) {
  df[which(df[[l]] > 0 | df[[u]] < 0), ]
} 

# 0-10
blkC.ts.10.lm <- lm(c_pct ~ year * PMeco, sra.01.09.19.blkC.reps[sra.01.09.19.blkC.reps$lyr_bot == 10, ])
blkC.ts.10.emt <- emtrends(blkC.ts.10.lm, pairwise ~ PMeco, var = "year")
# -ANpp, +ANrf, -BSrf

# 10-20
blkC.ts.20.lm <- lm(c_pct ~ year * PMeco, sra.01.09.19.blkC.reps[sra.01.09.19.blkC.reps$lyr_bot == 20, ])
blkC.ts.20.emt <- emtrends(blkC.ts.20.lm, pairwise ~ PMeco, var = "year")
# +ANrf, +GRpp

# 20-30
blkC.ts.30.lm <- lm(c_pct ~ year * PMeco, sra.01.09.19.blkC.reps[sra.01.09.19.blkC.reps$lyr_bot == 30, ])
blkC.ts.30.emt <- emtrends(blkC.ts.30.lm, pairwise ~ PMeco, var = "year")
# +ANrf

# table of significant changes
blkC.ts.sig.df <- bind_rows(lapply(
  list(data.frame(blkC.ts.10.emt$emtrends),
       data.frame(blkC.ts.20.emt$emtrends),
       data.frame(blkC.ts.30.emt$emtrends)), function(df) {
         confint.X0.fx(df, "lower.CL", "upper.CL")
       }), .id = "Depth") %>%
  mutate(Depth = ifelse(Depth == 1, "0-10cm", 
                        ifelse(Depth == 2, "10-20cm", "20-30cm")),
         across(c("year.trend", "SE", "lower.CL", "upper.CL"), ~ round(., 2)),
         Site = ifelse(PMeco == "ANpp", "andesite (warm)",
                       ifelse(PMeco == "ANrf", "andesite (cold)",
                              ifelse(PMeco == "BSrf", "basalt (cold)", "granite (warm)")))) %>%
  select(c(Depth, Site, year.trend, SE, df, lower.CL, upper.CL))
```

We did not observe clear trends in soil carbon concentration over time for the majority of sites, making us confident that most sites are at steady-state with regards to carbon stock changes (**Fig. \@ref(fig:plot-C-timeseries)**). Although we did observe substantial variation in some sites, this is likely due to spatial heterogeneity in soil C concentration that cannot be avoided when destructively resampling the same sites over time (**Fig. \@ref(fig:plot-C-timeseries)**). However, we did observe significant trends in soil C concentration with time for a a few of the sites when considered by specific depth increments. However, a caveat is that we did not account for potential differences in the mass of soil sampled over time, as we only considered depth-based increments. We observed significant changes at two sites for the surface layer (0-0.1 m), and at two additional sites in the intermediate depth layer (0.1-0.2 m), but C concentration changes were only significant at a single site showed changes for the deepest depth layer (0.2-0.3 m) (**Table \@ref(tab:pct-C-change-tbl)**). The soil at the cold climate andesite site was an outlier in that the soil C concentration showed a consistently significant increase in the two deeper depth layers over the study period, while the other soils with significant changes showed decreases in C concentrations (**Table \@ref(tab:pct-C-change-tbl)**).

(ref:pct-C-change-tbl-cap) Changes in soil C concentration (%), 2001-2019. (Only signficant trends shown).

```{r pct-C-change-tbl}
# print table
kable(blkC.ts.sig.df,
      col.names = c(
        "Depth",
        "Site",
        "Trend",
        "$SE$",
        "df",
        "$lower$",
        "$upper$"),
      escape = FALSE,    
      longtable = TRUE,
      booktabs = TRUE,
      caption = "(ref:pct-C-change-tbl-cap)") %>%
    collapse_rows(1, latex_hline = "major", valign = "top") %>%
    add_header_above(c(" " = 5, "95% CI" = 2)) %>%
    kable_classic(full_width = FALSE, html_font = "Cambria") %>%
    kable_styling(latex_options = c("repeat_header"),
                  font_size = 10)
```

(ref:plot-ts-C-SI-cap) Changes in soil C concentration, 2001-2019. Points show replicate profiles (n = 3); lines show marginal mean estimates of linear trends in soil C concentration with time; ribbons show 95% CIs around trend estimates.  

```{r plot-C-timeseries, fig.cap="(ref:plot-ts-C-SI-cap)"}
# generate emmip objs
brks <- c(2001, 2009, 2019)
emmip.blkC.df <- rbind(
  emmip(blkC.ts.10.lm, PMeco ~ year, CIs = TRUE, at = list(year = brks))$data,
  emmip(blkC.ts.20.lm, PMeco ~ year, CIs = TRUE, at = list(year = brks))$data,
  emmip(blkC.ts.30.lm, PMeco ~ year, CIs = TRUE, at = list(year = brks))$data) %>%
  mutate(PM = substr(PMeco, 1, 2),
         ECO = factor(substr(PMeco, 3, 4), 
                      levels = c("pp", "wf", "rf"), 
                      labels = c("warm", "cool", "cold")),
         depth = rep(c("0-10", "10-20", "20-30"), each = 27))

# plot marginal mean trends
ggplot(emmip.blkC.df, aes(xvar, yvar)) +
  geom_line(aes(color = PM), size = 1.5) +
  geom_ribbon(aes(ymin = LCL, ymax = UCL, fill = PM), 
              alpha = .1, show.legend = FALSE) +
  geom_point(data = sra.01.09.19.blkC.reps, 
             aes(year, c_pct, color = PM, shape = ECO),
             size = 2, alpha = .6) +
  scale_color_manual(name = NULL,
                     values = c("AN" = andesite, 
                                "BS" = basalt, 
                                "GR" = granite),
                     labels = c("AN" = "andesite", 
                                "BS" = "basalt", 
                                "GR" = "granite")) +
  scale_fill_manual(name = NULL,
                    values = c("AN" = andesite, 
                               "BS" = basalt, 
                               "GR" = granite)) +
  scale_shape_manual(name = NULL, 
                     values = c("warm" = 15, 
                                "cool" = 17,
                                "cold" = 16)) +
  scale_x_continuous(limits = c(2000, 2020), 
                     breaks = brks, 
                     expand = expansion(add = 2)) +
  ylab("%C") +
  facet_grid(rows = vars(depth), cols = vars(ECO)) +
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        axis.title.x = element_blank(),
        text = element_text(size = 14))
```


```{r plot-soc-stocks, fig.cap="(ref:plot-SOC-profiles-cap)", fig.width=6, fig.height=5}
# (ref:plot-SOC-profiles-cap) Profiles of soil C stocks by year. Note that bulk density and coarse fragment data were not collected in 2019, so these values were spline-estimated from 2009 data for the 2019 profiles. Points show means; error bars show ±2SE.

# # 2001
# load("sra.01.blkC.RData")
# sra.01.soc.df <- bind_rows(
#   lapply(split(sra.01.blkC, sra.01.blkC$PMeco), function(df) {
#     depths(df) <- pro_name ~ lyr_top + lyr_bot
#     sp.df <- suppressMessages(
#       mpspline(df, var.name = "soc_kgm2", d = c(0, 10, 20, 30), 
#                show.progress = FALSE))$var.std 
#     sp.df$pro_rep <- seq(1, nrow(sp.df))
#     sp.df %>%
#       pivot_longer(cols = 1:3, names_to = "depth", values_to = "soc_kgm2")
#   }), .id = "PMeco") %>%
#   mutate(middepth = as.numeric(sapply(strsplit(depth, "-"), "[", 1)) + 5)
# 
# # 2009
# load("sra.09.blkC.RData")
# 
# # create plotting df
# sra.09.soc.df <- bind_rows(
#   lapply(split(sra.09.blkC, sra.09.blkC$PMeco), function(df) {
#     df$soc_kgm2 <- df$Thickness_cm * df$BD_g_cm_3 * df$C_pct * df$Soil_finefraction * 10^-1
#     depths(df) <- pro_name ~ top.mineral + bottom.mineral
#     sp.df <- suppressMessages(
#       mpspline(df, var.name = "soc_kgm2", d = c(0, 10, 20, 30), 
#                show.progress = FALSE))$var.std 
#     sp.df$pro_rep <- seq(1, nrow(sp.df))
#     sp.df %>%
#       pivot_longer(cols = 1:3, names_to = "depth", values_to = "soc_kgm2")
#   }), .id = "PMeco") %>%
#   mutate(middepth = as.numeric(sapply(strsplit(depth, "-"), "[", 1)) + 5)
# 
# # 2019 data
# # note: uses 2009 mass data splined to 2019 depths (BD, RF)
# load("sra.2019.ls.RData")
# sra.19.soc.df <- bind_rows(sra.2019.ls)
# 
# # Combine
# nms.soc <- c("PMeco", "middepth", "year", "soc_kgm2")
# sra.19.09.01.soc.df <- rbind(
#   sra.19.soc.df %>% 
#     mutate(year = 2019, middepth = lyr_bot - 5) %>% 
#     select(all_of(nms.soc)),
#   sra.09.soc.df %>% 
#     mutate(year = 2009) %>%
#     select(all_of(nms.soc)),
#   sra.01.soc.df %>% 
#     mutate(year = 2001) %>%
#     select(all_of(nms.soc))) %>%
#   mutate(PM = substr(PMeco, 1, 2),
#          eco = factor(substr(PMeco, 3, 4), levels = c("pp", "wf", "rf"),
#                       labels = c("warm", "cool", "cold")))
# 
# # # plot all years together
# # f_labs <- data.frame(soc_kgm2_mean = .5, middepth = 4, eco = c("warm", "cool", "cold"))
# # f_labs$label <- paste0(letters[1:3], ") ", f_labs$eco)
# # 
# # sra.19.09.01.soc.df %>%
# #   group_by(PMeco, PM, eco, middepth) %>%
# #   add_tally() %>%
# #   summarize(across(c(soc_kgm2, n), .fns = list(mean = mean, sd = sd))) %>%
# #   mutate(se = soc_kgm2_sd / sqrt(n_mean)) %>%
# #   arrange(middepth) %>%
# #   ggplot(., aes(soc_kgm2_mean, middepth)) +
# #   geom_point(aes(shape = eco, color = PM), size = 3) +
# #   geom_errorbarh(
# #     aes(xmax = soc_kgm2_mean + se * 2, xmin = soc_kgm2_mean - se * 2, color = PM),
# #     height = 1.2) +
# #   geom_path(aes(group = PMeco, color = PM)) +
# #   geom_text(data = f_labs, aes(label = label), 
# #             show.legend = FALSE, size = .36 * 12, fontface = "bold", hjust = "left") +
# #   scale_color_manual(name = NULL, 
# #                      values = c("AN" = andesite, 
# #                                 "BS" = basalt,
# #                                 "GR" = granite),
# #                      labels = c("AN" = "andesite", 
# #                                 "BS" = "basalt",
# #                                 "GR" = "granite")) +
# #   scale_shape_manual(name = NULL,
# #                      values = c("warm" = 15,
# #                                 "cool" = 17,
# #                                 "cold" = 16)) +
# #   scale_y_reverse(limits = c(30, 0)) +
# #   facet_grid(rows = vars(eco)) +
# #   ylab("Depth (cm)") +
# #   xlab(expression('SOC (kg m'^-2*')')) +
# #   theme_bw() +
# #   theme(panel.grid = element_blank(),
# #         text = element_text(size = 14),
# #         strip.background = element_blank(),
# #         strip.text = element_blank())
# 
# # plot years separately
# f_labs <- data.frame(soc_kgm2_mean = .5, middepth = 2, eco = rep(c("warm", "cool", "cold"), 3), year = rep(c(2001, 2009, 2019), ea = 3))
# f_labs$label <- paste0(letters[1:9], ") ", f_labs$eco, ", ", f_labs$year)
# 
# sra.19.09.01.soc.df %>%
#   group_by(year, PMeco, PM, eco, middepth) %>%
#   summarize(across(soc_kgm2, .fns = list(mean = mean, sd = sd)),
#             n = n()) %>%
#   mutate(se = soc_kgm2_sd / sqrt(n)) %>%
#   ggplot(., aes(soc_kgm2_mean, middepth)) +
#   geom_point(aes(shape = eco, color = PM), size = 3) +
#   geom_text(data = f_labs, aes(label = label), show.legend = FALSE,
#             size = .36 * 10, fontface = "bold", hjust = "left") +
#   geom_errorbarh(
#     aes(xmax = soc_kgm2_mean + se * 2, xmin = soc_kgm2_mean - se * 2, color = PM),
#     height = 1.2) +
#   geom_path(aes(group = PMeco, color = PM)) +
#   scale_color_manual(name = NULL, 
#                      values = c("AN" = andesite, 
#                                 "BS" = basalt,
#                                 "GR" = granite),
#                      labels = c("AN" = "andesite", 
#                                 "BS" = "basalt",
#                                 "GR" = "granite")) +
#   scale_shape_manual(name = NULL,
#                      values = c("warm" = 15,
#                                 "cool" = 17,
#                                 "cold" = 16)) +
#   scale_y_reverse(limits = c(30, 0)) +
#   facet_grid(rows = vars(year), cols = vars(eco)) +
#   ylab("Depth (cm)") +
#   xlab(expression('SOC (kg m'^-2*')')) +
#   theme_bw() +
#   theme(panel.grid = element_blank(),
#         text = element_text(size = 14),
#         strip.background = element_blank(),
#         strip.text = element_blank())
```

\clearpage

# Respiration fluxes

```{r read-resp-ts}
# load flux time series
load("ts.RData")

# add depth index
t1 <- ts[ts$timepoint_cmtv == 1, ]
t1 <- data.frame(
  bind_rows(
    lapply(split(t1, t1$year), function(df) {
      bind_rows(lapply(split(df, df$PMeco), function(x) {
        x <- x[x$rep == "a", ]
        x$lyr_top <- as.numeric(sapply(strsplit(x$depth, "-"), "[", 1))
        x <- x[order(x$lyr_top), ]
        x$depth_index <- seq(1, nrow(x))
        return(x)
      }))
    })))
ts$depth_index <- t1[match(ts$ID2, t1$ID2), "depth_index"]

# average reps for plotting time series
ts.avg <- ts %>%
  group_by(PMeco, year, depth_index, timepoint_cmtv) %>%
  summarize(time_d = mean(time_d),
            mgCO2_gC_d_avg = mean(mgCO2_gC_d),
            mgCO2_gC_d_max = max(mgCO2_gC_d),
            mgCO2_gC_d_min = min(mgCO2_gC_d),
            mgCO2_gC_avg = mean(mgCO2_gC),
            mgCO2_gC_max = max(mgCO2_gC),
            mgCO2_gC_min = min(mgCO2_gC), .groups = "keep")
```

(ref:plot-cmtv-flx-rates-cap) Heterotrophic respiration rates from incubations of 2019 and 2001 samples. Panels a-c show 2019 data, and panels d-f show 2001 data. Panels in the top row (a, d) show the first depth increment for each year, middle row shows the second depth increment (b, e), and the bottom row shows the third depth increment (c, f). Bars show means for laboratory duplicates averaged over the whole incubation period; error bars ± 1 standard error of the mean. NB: Total CO~2~ respired was controlled to be within 10,000 ppm (±1,000 ppm) for all samples; incubation duration varied between 4 and 40 days.

```{r plot-cmtv-flx-rates, fig.cap="(ref:plot-cmtv-flx-rates-cap)"}
# plot mean flux rate for all timepoints
ts.avg.cmtv <- ts %>% 
  group_by(PMeco, year, depth_index) %>%
  summarize(mgCO2_gC_d_avg = mean(mgCO2_gC_d),
            mgCO2_gC_d_sd = sd(mgCO2_gC_d),
            n = n(), .groups = "keep") %>%
  mutate(mgCO2_gC_d_se = mgCO2_gC_d_sd / n)

# plot fx
plot.cmtv.flx <- function(ts.df, year) {
  ts.df[which(ts.df$year == year), ] %>%
    filter(year == year) %>%
    mutate(PM = ifelse(substr(PMeco, 1, 2) == "AN", "andesite", 
                       ifelse(substr(PMeco, 1, 2) == "BS", "basalt", "granite")),
           eco = factor(ifelse(substr(PMeco, 3, 4) == "pp", "warm",
                               ifelse(substr(PMeco, 3, 4) == "wf", "cool", "cold")),
                        levels = c("warm", "cool", "cold"))) %>%
    ggplot(., aes(eco, mgCO2_gC_d_avg, fill = PM)) +
    geom_col(position = position_dodge(preserve = "single")) +
    geom_errorbar(
      aes(ymin = mgCO2_gC_d_avg - mgCO2_gC_d_se, 
          ymax = mgCO2_gC_d_avg + mgCO2_gC_d_se),
      width = .2,
      position = position_dodge(preserve = "single", width = .9)) +
    scale_fill_manual(name = "",
                      values = c("andesite" = andesite,
                                 "basalt" = basalt,
                                 "granite" = granite)) +
    ylab(NULL) +
    xlab(NULL) +
    theme_bw() +
    theme(panel.grid = element_blank())
}

# whiteout x-axis fx from plots 1, 2 of ls
x.axis.white.fx <- function(ls) {
  lapply(seq_along(ls), function(i) {
    if (i == 3) {
      ls[[i]]
    } else {
      ls[[i]] <-  ls[[i]] + theme(axis.text.x = element_text(color = "white"))
    }
  })
}

# y-axis
resp.y.grob <- textGrob(expression('Flux rate (mgCO'[2]*'-C gC'^-1*' d'^-1*')'), 
                        gp = gpar(fontface = "bold", fontsize = 12), rot = 90)

# plot
resp.19 <- plot_grid(
  plotlist = x.axis.white.fx(
    lapply(split(ts.avg.cmtv, ts.avg.cmtv$depth_index), function(df) {
      plot.cmtv.flx(df, "2019") + theme(legend.position = "none")
   })), ncol = 1, labels = paste0(letters[1:3], ")"), 
  label_x = .92, hjust = 0, vjust = 2.2, label_size = 10)
resp.01 <- plot_grid(
  plotlist = x.axis.white.fx(
    lapply(split(ts.avg.cmtv, ts.avg.cmtv$depth_index), function(df) {
      plot.cmtv.flx(df, "2001") + theme(legend.position = "none")
   })
   ), ncol = 1, labels = paste0(letters[4:6], ")"), 
  label_x = .92, hjust = 0, vjust = 2.2, label_size = 10)

pg.resp <- arrangeGrob(plot_grid(resp.19, resp.01, ncol = 2), left = resp.y.grob)

resp.lg <- get_legend(
  plot.cmtv.flx(ts.avg.cmtv, "2019") +
    guides(fill = guide_legend(nrow = 1)) +
    theme(legend.position = "bottom",
          legend.text = element_text(size = 9))
)
plot_grid(pg.resp, resp.lg, ncol = 1, rel_heights = c(1, .2))
```


```{r plot-C-resp-rates-ts, fig.cap="(ref:plot-C-resp-rates-ts-cap)"}
# (ref:plot-C-resp-rates-ts-cap) Time series of heterotrophic respiration rates from incubations by depth and year (i.e. samples from the same year and depth interval are plotted on the same scale). Rows correspond to climate zones, columns correspond to depths; leftmost column shows top depth, rightmost column shows deepest depth. Top set of panels (a-c, g-i, and m-o) show 2019 data, bottom set of panels (d-f, j-l, p-r) show 2001 data. Lines show means for laboratory duplicates; ribbon shows minimum and maximum of laboratory duplicates. NB: Total CO~2~ respired was controlled to be within 10,000 ppm (±1,000 ppm) for all samples.

# function for plotting ts
# ts.plot.fx <- function(df, yr, increment, legend.pos = "none", 
#                        ylab = FALSE, cumulative = FALSE) {
#   
#   # ylab
#   if (ylab) {
#     if (cumulative) {
#      ylab <- expression('Cumulative flux (mgCO'[2]*'-C gC'^-1*')') 
#     } else {
#      ylab <- expression('Respiration Rate (mgCO'[2]*'-C gC'^-1*'d'^-1*')')
#     }
#   } else {
#     ylab <- ""
#   }
#   
#   # filter and mutate
#   df <- df %>%
#     filter(year == yr & depth_index == increment) %>%
#     mutate(PM = ifelse(grepl("AN", PMeco), "AN",
#                        ifelse(grepl("BS", PMeco), "BS", "GR")),
#            eco = factor(ifelse(grepl("rf", PMeco), "rf",
#                                ifelse(grepl("wf", PMeco), "wf", "pp")),
#                         levels = c("pp", "wf", "rf")))
#   
#   # set facet labels
#   f_labs <- paste0(letters[1:18], ")")
#   if (yr == "2019") {
#     f_labs <- f_labs[c(1:3, 7:9, 13:15)]
#   } else {
#     f_labs <- f_labs[c(4:6, 10:12, 16:18)]
#   }
#   if (increment == "1") {
#     ix <- 1:3
#   } else if (increment == "2") {
#     ix <- 4:6
#   } else {
#     ix <- 7:9
#   }
#   f_labs <- c("pp" = f_labs[ix][1],
#               "wf" = f_labs[ix][2],
#               "rf" = f_labs[ix][3])
#   
#   # plot fxs
#   if (cumulative) {
#     p <- ggplot(df, aes(time_d, mgCO2_gC_avg, 
#                         color = PM, fill = PM, shape = eco)) +
#       geom_ribbon(aes(ymin = mgCO2_gC_max, ymax = mgCO2_gC_min),
#                   alpha = 0.2, linetype = 0, show.legend = FALSE) +
#       geom_point(aes(time_d, mgCO2_gC_max), size = 1) +
#       geom_point(aes(time_d, mgCO2_gC_min), size = 1)
#   } else {
#     p <- ggplot(df, aes(time_d, mgCO2_gC_d_avg, 
#                         color = PM, fill = PM, shape = eco)) +
#       geom_ribbon(aes(ymin = mgCO2_gC_d_max, ymax = mgCO2_gC_d_min), 
#                   alpha = 0.2, linetype = 0, show.legend = FALSE) +
#       geom_point(aes(time_d, mgCO2_gC_d_max), size = 1) +
#       geom_point(aes(time_d, mgCO2_gC_d_min), size = 1)
#   }
#     p <- p +
#       geom_line(size = .8) +
#       scale_x_continuous(limits = c(0, 30)) +
#       scale_y_continuous(breaks = scales::breaks_pretty(n = 3),
#                          labels = scales::number_format(accuracy = 0.01)) +
#       scale_color_manual(name = "",
#                          labels = c("AN" = "andesite",
#                                     "BS" = "basalt",
#                                     "GR" = "granite"),
#                          values = c("AN" = andesite, 
#                                     "BS" = basalt, 
#                                     "GR" = granite)) +
#       scale_shape_manual(name = "",
#                          labels = c("rf" = "cold",
#                                     "wf" = "cool",
#                                     "pp" = "warm"),
#                          values = c("pp" = 15, 
#                                     "rf" = 16, 
#                                     "wf" = 17)) +
#       scale_fill_manual(values = c("AN" = andesite, 
#                                    "BS" = basalt, 
#                                    "GR" = granite)) +
#       facet_grid(rows = vars(eco), 
#                  labeller = labeller(eco = f_labs)) +
#       ylab(ylab) +
#       theme_bw() +
#       theme(panel.grid = element_blank(),
#             strip.background = element_blank(),
#             strip.text.y = element_text(
#               face = "bold", angle = 0, hjust = 0, vjust = 1, size = 10),
#             axis.title.x = element_blank(),
#             plot.margin = unit(c(.1, 0, 0, 0), "cm"),
#             legend.position = legend.pos)
# }
# 
# ## plot flux rates
# ts.flx.rates.p.ls <- plot_grid(
#   plotlist = list(
#     ts.plot.fx(ts.avg, yr = "2019", increment = "1"),
#     ts.plot.fx(ts.avg, yr = "2019", increment = "2"),
#     ts.plot.fx(ts.avg, yr = "2019", increment = "3"),
#     ts.plot.fx(ts.avg, yr = "2001", increment = "1"),
#     ts.plot.fx(ts.avg, yr = "2001", increment = "2"),
#     ts.plot.fx(ts.avg, yr = "2001", increment = "3")))
# 
# # add common labels for axes
# y.grob <- textGrob(expression('Respiration Rate (mgCO'[2]*'-C gC'^-1*'d'^-1*')'), 
#                    gp = gpar(fontface = "bold", fontsize = 12), rot = 90)
# x.grob <- textGrob(expression('Time (days)'), 
#                    gp = gpar(fontface = "bold", fontsize = 12))
# pg <- arrangeGrob(ts.flx.rates.p.ls, left = y.grob, bottom = x.grob)
# 
# # get legend
# lg <- get_legend(
#   ts.plot.fx(ts.avg, yr = "2019", increment = "1", legend.pos = "bottom") +
#     guides(color = guide_legend(nrow = 1, order = 3),
#            shape = guide_legend(nrow = 1),
#            fill = "none"))
# 
# # plot
# plot_grid(pg, lg, ncol = 1, rel_heights = c(1, .08))
```

\clearpage

# Radiocarbon depth profiles: 2001 data

Depth profiles of $\Delta$^14^C~*bulk*~ were similar in 2001 (**Fig. \@ref(fig:plot-d14c-pro-01)**) as to what we observed in 2019. We observed the most depleted ^14^C overall in the cool climate sites, where we also observed the clearest differences among parent materials. Parent material differences were least apparent for the cold climate sites, as we also observed in 2019. Within climate zones andesitic soils tended be most depleted and the granitic soils most enriched, with the basaltic parent material intermediate between the other two. 

```{r bulk-inc-plot-data}
# 2001
load("sra.01.inc.blk.RData")

# atm 14c
atm.01.19 <- data.frame(d14c = atm.14c[atm.14c$Year == 2001.5 | atm.14c$Year == 2019.5, "d14c"],
                        Year = c("2001", "2019"),
                        Type = "atmosphere")

# plot 2001 by climate, bulk and inc separated
# make df
sra.blk.inc.01.df <- sra.01.inc.blk %>%
  mutate(
    pm = factor(recode(PM, `AN` = "andesite", `BS` = "basalt", `GR` = "granite")),
    eco = factor(recode(ECO, `pp` = "warm", `wf` = "cool", `rf` = "cold"),
                      levels = c("warm", "cool", "cold")),
    Type = ifelse(Type == "inc", "respired", "bulk soil")) %>%
  mutate(ECOtype = factor(paste0(eco, " (", Type, ")"),
                          levels = c("warm (bulk soil)",
                                     "cool (bulk soil)",
                                     "cold (bulk soil)",
                                     "warm (respired)",
                                     "cool (respired)",
                                     "cold (respired)"))) %>%
  filter(lyr_bot > 0)

# make list, split by desired facet (Type)
sra.blk.inc.01.ls <- split(sra.blk.inc.01.df, sra.blk.inc.01.df$Type)

# plot fx
sra.blk.inc.pro.p.fx2 <- function(df) {
  
  # labels
  f_labs <- data.frame(eco = c("warm", "cool", "cold"))
  if (grepl("bulk soil", unique(df$Type))) {
    f_labs$label <- paste0("(", letters[1:3], ") ", f_labs$eco)
    xlab <- expression(Delta*''^14*'C'[italic(bulk)]*' (‰)')
  } else {
    f_labs$label <- paste0("(", letters[4:6], ") ", f_labs$eco)
    xlab <- expression(Delta*''^14*'C'[italic(respired)]*' (‰)')
  }
  
  df2 <- bind_rows(lapply(split(df, df$PMeco), function(x) {
    x$lyr_top <- NA
    for (i in 1:nrow(x)) {
      if (i == 1) {
        x$lyr_top[i] <- 0
      } else {
        x$lyr_top[i] <- x$lyr_bot[i-1]
      }
    }
    x$middepth <- x$lyr_top + (x$lyr_bot - x$lyr_top) / 2
    return(x)
  }))
  
  # plot
  ggplot(df2, aes(d14c_mean, middepth / 100)) +
    geom_vline(data = atm.01.19[atm.01.19$Year == "2001", ], 
               aes(xintercept = d14c, linetype = Type), color = "darkgray", show.legend = FALSE) +
    geom_hline(yintercept = 0) +
    geom_point(size = 2, aes(color = pm, shape = ECOtype)) +
    geom_errorbarh(
      aes(xmin = d14c_l, 
          xmax = d14c_u,
          color = pm), 
      height = .006, show.legend = FALSE) +
    geom_path(aes(color = pm, linetype = Type)) +
    scale_y_reverse() +
    scale_color_manual(name = NULL,
                       values = c("andesite" = andesite, 
                                  "basalt" = basalt, 
                                  "granite" = granite)) +
    scale_shape_manual(name = NULL,
                       limits = c("warm (bulk soil)", 
                                  "cool (bulk soil)", 
                                  "cold (bulk soil)",
                                  "warm (respired)", 
                                  "cool (respired)", 
                                  "cold (respired)"),
                       values = c("warm (bulk soil)" = 15, 
                                  "cool (bulk soil)" = 17, 
                                  "cold (bulk soil)" = 16,
                                  "warm (respired)" = 0, 
                                  "cool (respired)" = 2, 
                                  "cold (respired)" = 1)) +
    scale_linetype_manual(name = NULL,
                          limits = c("bulk soil", 
                                     "respired",
                                     "atmosphere"),
                          values = c("bulk soil" = 1, 
                                     "respired" = 2,
                                     "atmosphere" = 3)) +
    coord_cartesian(
      xlim = c(-100, 200), 
      ylim = c(.34, 0),
      expand = FALSE) +
    scale_x_continuous(breaks = c(-100, -50, 0, 50, 100)) +
    facet_grid(cols = vars(eco)) +
    geom_text(data = f_labs, aes(x = -95, y = 4, label = label), 
              size = .36 * 12, fontface = "bold", hjust = "left") +
    xlab(xlab) +
    theme_bw() +
    theme(panel.grid = element_blank(),
          strip.text = element_blank(),
          strip.background = element_blank(),
          axis.text = element_text(size = 11),
          axis.text.y = element_text(size = 12),
          axis.title.y = element_blank(),
          legend.position = "none")
}
```

(ref:plot-d14c-pro-01-cap) Depth profiles of $\Delta$^14^C~bulk~ and $\Delta$^14^C~respired~ for 2001 data. Top panels show bulk data, bottom panels respired data. Dotted vertical lines show $\Delta$^14^C of the atmosphere in the year of sampling. Points show the mean of three replicate profiles for bulk soil, and the mean of laboratory duplicates for respired CO~2~. Error bars show ±1 SD for bulk soils and the minimum and maximum for respired CO~2~. Respired CO~2~ from the cold granite site (panel f) was extremely depleted in $\Delta$^14^C and thus is excluded for display purposes.

```{r plot-d14c-pro-01, fig.cap="(ref:plot-d14c-pro-01-cap)", fig.height=5}
# plot list 
sra.blk.inc.pro.p.ls2 <- lapply(sra.blk.inc.01.ls, sra.blk.inc.pro.p.fx2)

# plot grid
sra.blk.inc.pro.p.g2 <- plot_grid(plotlist = sra.blk.inc.pro.p.ls2, nrow = 2)

# add common labels for axes
y.grob <- textGrob("Depth (cm)", 
                   gp = gpar(fontface = "bold", fontsize = 12), rot = 90)
pg <- arrangeGrob(sra.blk.inc.pro.p.g2, left = y.grob)

# get legend
blk.inc.pro.legend <- get_legend(
    sra.blk.inc.pro.p.ls2[[1]] +
      theme(legend.box.margin = margin(0, 0, 0, 12),
            legend.position = "right"))

# plot
plot_grid(pg, blk.inc.pro.legend, rel_widths = c(4, 1))
```

\clearpage

# Parent material and climate effects on bulk and respired ^14^C
## Contrasts

```{r models-blk-sum-con, include = FALSE}
# load 14c 
load("sra.01.09.19.d.10df.RData")
load("sra.01.09.19.d.20df.RData")
load("sra.01.09.19.d.30df.RData")

# contrasts fx
sra.PMeco.con.fx <- function(data, Year, con, out = "contrasts") {
  dat <- data[data$Year == Year, ]
  if (con == "PM | ECO") {
    emm <- emmeans(lm(d14c ~ PM * ECO, dat), pairwise ~ PM | ECO) 
  } else {
    emm <- emmeans(lm(d14c ~ PM * ECO, dat), pairwise ~ ECO | PM) 
  }
  
  # out
  if (out == "atm") {
    em.df <- data.frame(emm$emmeans)
    em.df$atm <- atm.01.19[atm.01.19$Year == Year, "d14c"]
    em.df$atm.return <- ifelse(
      em.df$atm < em.df$lower.CL, "enriched",
      ifelse(em.df$atm > em.df$upper.CL, "depleted", "equal"))
    em.df[ , c(1, 2, 9)]
  } else if (out == "contrasts") {
    emm$contrasts
  } else if (out == "emmeans") {
    emm$emmeans
  } else {
    emm
  }
}

## 0-10
# mod
blk.PMeco.10.lm <- lm(d14c ~ PM * ECO * year, sra.01.09.19.d.10df)
summary(blk.PMeco.10.lm)
# trends
blk.PMeco.10.et <- emtrends(blk.PMeco.10.lm, pairwise ~ PM * ECO, var = "year")
# ordered trends
# c(-6.1, -5, -2.8, -2.3, -2.1, -1.9, -.3, .1, .8)
# contrasts
ctr.blk.PMeco.10.01 <- sra.PMeco.con.fx(sra.01.09.19.d.10df, 2001, "PM | ECO")
ctr.blk.ecoPM.10.01 <- sra.PMeco.con.fx(sra.01.09.19.d.10df, 2001, "ECO | PM")
ctr.blk.PMeco.10.19 <- sra.PMeco.con.fx(sra.01.09.19.d.10df, 2019, "PM | ECO")
ctr.blk.ecoPM.10.19 <- sra.PMeco.con.fx(sra.01.09.19.d.10df, 2019, "ECO | PM")
# atm
sra.PMeco.con.fx(sra.01.09.19.d.10df, 2001, "PM | ECO", out = "atm")
sra.PMeco.con.fx(sra.01.09.19.d.10df, 2019, "PM | ECO", out = "atm")

## 10-20
# mod
blk.PMeco.20.lm <- lm(d14c ~ PM * ECO * year, sra.01.09.19.d.20df)
summary(blk.PMeco.20.lm)
# trends
blk.PMeco.20.et <- emtrends(blk.PMeco.20.lm, pairwise ~ PM * ECO, var = "year")
# ordered trends
# c(-3.7, -3.7, -2.1, -1.1, -.3, -.2, .42, .43, 2.1)
# contrasts
ctr.blk.PMeco.20.01 <- sra.PMeco.con.fx(sra.01.09.19.d.20df, 2001, "PM | ECO")
ctr.blk.ecoPM.20.01 <- sra.PMeco.con.fx(sra.01.09.19.d.20df, 2001, "ECO | PM")
ctr.blk.PMeco.20.19 <- sra.PMeco.con.fx(sra.01.09.19.d.20df, 2019, "PM | ECO")
ctr.blk.ecoPM.20.19 <- sra.PMeco.con.fx(sra.01.09.19.d.20df, 2019, "ECO | PM")
# atm
sra.PMeco.con.fx(sra.01.09.19.d.20df, 2001, "PM | ECO", out = "atm")
sra.PMeco.con.fx(sra.01.09.19.d.20df, 2019, "PM | ECO", out = "atm")

## 20-30
# mod
blk.PMeco.30.lm <- lm(d14c ~ PM * ECO * year, sra.01.09.19.d.30df)
summary(blk.PMeco.30.lm)
# trends
blk.PMeco.30.et <- emtrends(blk.PMeco.30.lm, pairwise ~ PM * ECO, var = "year")
# ordered trends
# c(-6.4, -3.6, -1, .2, .3, .3, .3, 1.1, 1.6)
# contrasts
ctr.blk.PMeco.30.01 <- sra.PMeco.con.fx(sra.01.09.19.d.30df, 2001, "PM | ECO")
ctr.blk.ecoPM.30.01 <- sra.PMeco.con.fx(sra.01.09.19.d.30df, 2001, "ECO | PM")
ctr.blk.PMeco.30.19 <- sra.PMeco.con.fx(sra.01.09.19.d.30df, 2019, "PM | ECO")
ctr.blk.ecoPM.30.19 <- sra.PMeco.con.fx(sra.01.09.19.d.30df, 2019, "ECO | PM")
# atm
sra.PMeco.con.fx(sra.01.09.19.d.30df, 2001, "PM | ECO", out = "atm")
sra.PMeco.con.fx(sra.01.09.19.d.30df, 2019, "PM | ECO", out = "atm")
```

```{r models-inc-10-sum-con, include = FALSE}
# load data
load("sra.01.09.19.inc.d.10df.RData")
load("sra.01.09.19.inc.d.20df.RData")
load("sra.01.09.19.inc.d.30df.RData")

# 0-10cm
inc.PMeco.10.lm <- lm(d14c ~ PM * ECO * year, sra.01.19.inc.d.10.df)
summary(inc.PMeco.10.lm)
inc.PMeco.10.et <- emtrends(inc.PMeco.10.lm, pairwise ~ PM * ECO, var = "year")
# ordered trends
# c(-6.2 ANpp, -4.9 GRpp, -3.9 BSrf, -3.7 BSwf, -3.1 GRwf, -2.9 ANrf, -2.3 BSpp, -1.4 ANwf, .1 GRrf)
# ggplot(data.frame(inc.PMeco.10.et$emtrends), aes(ECO, year.trend)) + geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL, color = ECO), width = .2) + geom_col(aes(fill = ECO), position = "dodge") + scale_fill_manual(values = c("warm" = warm, "cool" = cool, "cold" = cold)) + scale_color_manual(values = c("warm" = warm, "cool" = cool, "cold" = cold)) + scale_y_reverse() + facet_grid(cols = vars(PM)) + theme_bw()

# contrasts
ctr.inc.PMeco.10.01 <- sra.PMeco.con.fx(sra.01.19.inc.d.10.df, 2001, "PM | ECO")
ctr.inc.ecoPM.10.01 <- sra.PMeco.con.fx(sra.01.19.inc.d.10.df, 2001, "ECO | PM")
ctr.inc.PMeco.10.19 <- sra.PMeco.con.fx(sra.01.19.inc.d.10.df, 2019, "PM | ECO")
ctr.inc.ecoPM.10.19 <- sra.PMeco.con.fx(sra.01.19.inc.d.10.df, 2019, "ECO | PM")
# atm
sra.PMeco.con.fx(sra.01.19.inc.d.10.df, 2001, "PM | ECO", out = "atm")
sra.PMeco.con.fx(sra.01.19.inc.d.10.df, 2019, "PM | ECO", out = "atm")

# mean trends
inc.PMeco.10.et.ECO.sum <- data.frame(inc.PMeco.10.et$emtrends) %>% 
  group_by(ECO) %>% 
  summarize(across(year.trend, .fns = c(mean = mean, sd = sd)))

# 10-20
inc.PMeco.20.lm <- lm(d14c ~ PM * ECO * year, sra.01.19.inc.d.20.df)
summary(inc.PMeco.20.lm)
inc.PMeco.20.et <- emtrends(inc.PMeco.20.lm, pairwise ~ PM * ECO, var = "year")
# ordered trends
# c(-5.9, -4.3, -3.9, -2.2, -1.1, -1, -.8, 1.4, 4.8)
# contrasts
ctr.inc.PMeco.20.01 <- sra.PMeco.con.fx(sra.01.19.inc.d.20.df, 2001, "PM | ECO")
ctr.inc.ecoPM.20.01 <- sra.PMeco.con.fx(sra.01.19.inc.d.20.df, 2001, "ECO | PM")
ctr.inc.PMeco.20.19 <- sra.PMeco.con.fx(sra.01.19.inc.d.20.df, 2019, "PM | ECO")
ctr.inc.ecoPM.20.19 <- sra.PMeco.con.fx(sra.01.19.inc.d.20.df, 2019, "ECO | PM")
# atm
sra.PMeco.con.fx(sra.01.19.inc.d.20.df, 2001, "PM | ECO", out = "atm")
sra.PMeco.con.fx(sra.01.19.inc.d.20.df, 2019, "PM | ECO", out = "atm")

# 20-30
inc.PMeco.30.lm <- lm(d14c ~ PM * ECO * year, sra.01.19.inc.d.30.df)
summary(inc.PMeco.30.lm)
inc.PMeco.30.et <- emtrends(inc.PMeco.30.lm, pairwise ~ PM * ECO, var = "year")
# ordered trends
# c(-7.8, -3.5, -1.5, .1, .5, 1.4, 1.5, 2.8, 9.7)
# contrasts
ctr.inc.PMeco.30.01 <- sra.PMeco.con.fx(sra.01.19.inc.d.30.df, 2001, "PM | ECO")
ctr.inc.ecoPM.30.01 <- sra.PMeco.con.fx(sra.01.19.inc.d.30.df, 2001, "ECO | PM")
ctr.inc.PMeco.30.19 <- sra.PMeco.con.fx(sra.01.19.inc.d.30.df, 2019, "PM | ECO")
ctr.inc.ecoPM.30.19 <- sra.PMeco.con.fx(sra.01.19.inc.d.30.df, 2019, "ECO | PM")
# atm
sra.PMeco.con.fx(sra.01.19.inc.d.30.df, 2001, "PM | ECO", out = "atm")
sra.PMeco.con.fx(sra.01.19.inc.d.30.df, 2019, "PM | ECO", out = "atm")
```

```{r blk-inc-contrasts-setup}
contrasts.tbl.fx <- function(ctrPMeco.1, ctrECOpm.1, 
                             ctrPMeco.2, ctrECOpm.2,
                             ctrPMeco.3, ctrECOpm.3, caption, year) {
  # bind into combined data frame
  ctrC.df <- rapply(list(
  list(ctrPMeco.1, ctrECOpm.1),
  list(ctrPMeco.2, ctrECOpm.2),
  list(ctrPMeco.3, ctrECOpm.3)), function(x) {
    df <- sig.cts.fx(data.frame(x))
    names(df)[2] <- "Group"
    return(df)
  }, how = "list")
  names(ctrC.df) <- c("0-0.1 m", "0.1-0.2 m", "0.2-0.3 m")
  
  # rearrange for printing
  return(
    bind_rows(ctrC.df, .id = "id") %>%
      mutate(Year = year, Depth = ifelse(id < 3, "0-0.1 m", ifelse(id < 5, "0.1-0.2 m", "0.2-0.3 m")),
             across(p.value, function(x) {
               case_when(!is.na(x) ~ pvalForm.fx(x))}),
             across(c(estimate, SE), ~ round(., 1))) %>%
      select(Year, Depth, Group, contrast, estimate, SE, p.value))
}
```

(ref:blk-inc-contrasts-cap) Contrasts for bulk and respired $\Delta$^14^C by year and depth. P value adjustment: Tukey method for comparing a family of 3 estimates.

```{r blk-inc-contrasts-prep}
# print kable
cts.blk.01 <- contrasts.tbl.fx(ctr.blk.PMeco.10.01, ctr.blk.ecoPM.10.01,
                                ctr.blk.PMeco.20.01, ctr.blk.ecoPM.20.01, 
                                ctr.blk.PMeco.30.01, ctr.blk.ecoPM.30.01, 
                                "bulk contrasts, '19", 2001)
cts.blk.19 <- contrasts.tbl.fx(ctr.blk.PMeco.10.19, ctr.blk.ecoPM.10.19,
                                ctr.blk.PMeco.20.19, ctr.blk.ecoPM.20.19, 
                                ctr.blk.PMeco.30.19, ctr.blk.ecoPM.30.19, 
                                "bulk contrasts, '19", 2019)
cts.inc.01 <- contrasts.tbl.fx(ctr.inc.PMeco.10.01, ctr.inc.ecoPM.10.01,
                                ctr.inc.PMeco.20.01, ctr.inc.ecoPM.20.01, 
                                ctr.inc.PMeco.30.01, ctr.inc.ecoPM.30.01, 
                                "inc contrasts, '19", 2001)
cts.inc.19 <- contrasts.tbl.fx(ctr.inc.PMeco.10.19, ctr.inc.ecoPM.10.19,
                                ctr.inc.PMeco.20.19, ctr.inc.ecoPM.20.19, 
                                ctr.inc.PMeco.30.19, ctr.inc.ecoPM.30.19, 
                                "inc contrasts, '19", 2019)

# join
cts.blk.inc.df <- merge(
  rbind(cts.blk.01, cts.blk.19), rbind(cts.inc.01, cts.inc.19),
  by = c("Year", "Depth", "Group", "contrast"), all = TRUE)
cts.blk.inc.ls <- split(cts.blk.inc.df, cts.blk.inc.df$Depth)
cts.blk.inc.10 <- cts.blk.inc.ls$`0-0.1 m`
cts.blk.inc.20 <- cts.blk.inc.ls$`0.1-0.2 m`
cts.blk.inc.30 <- cts.blk.inc.ls$`0.2-0.3 m`

# set NA to blank
options(knitr.kable.NA = '')

# print kable
cts.table.fx <- function(df, cap) {
  df %>% 
    select(-Depth) %>%
    kable(.,
          col.names = c(
            "Year",
            "Group",
            "Contrast",
            "Est.",
            "$SE$",
            "$p$",
            "Est.",
            "$SE$",
            "$p$"),
          escape = FALSE,    
          longtable = TRUE,
          booktabs = TRUE,
          caption = cap,
          row.names = FALSE) %>%
      collapse_rows(1:2, latex_hline = "major", valign = "top") %>%
      add_header_above(c(" " = 3, "Bulk" = 3, "Respired" = 3)) %>%
      kable_classic(full_width = FALSE, html_font = "Cambria") %>%
      kable_styling(font_size = 10)
}
```

(ref:blk-inc-contrasts-10-cap) Contrasts of bulk and respired $\Delta$^14^C for parent material and climate factors, 0-0.1 m (all pairs). P value adjustment: Tukey method for comparing a family of 3 estimates.

```{r blk-inc-contrasts-10}
cts.table.fx(cts.blk.inc.10, "(ref:blk-inc-contrasts-10-cap)")
```

(ref:blk-inc-contrasts-20-cap) Contrasts of bulk and respired $\Delta$^14^C for parent material and climate factors, 0.1-0.2 m (all pairs). P value adjustment: Tukey method for comparing a family of 3 estimates.

```{r blk-inc-contrasts-20}
cts.table.fx(cts.blk.inc.20, "(ref:blk-inc-contrasts-20-cap)")
```

(ref:blk-inc-contrasts-30-cap) Contrasts of bulk and respired $\Delta$^14^C for parent material and climate factors, 0.2-0.3 m (all pairs). P value adjustment: Tukey method for comparing a family of 3 estimates.

```{r blk-inc-contrasts-30}
cts.table.fx(cts.blk.inc.30, "(ref:blk-inc-contrasts-30-cap)")
```

\clearpage

## Temporal trends & contrasts

Please see the main text for discussion of the temporal trends in both $\Delta$^14^C~*bulk*~ and $\Delta$^14^C~*bulk*~. See SI tables **\@ref(tab:blk-trend-stats)** and **\@ref(tab:inc-trend-stats)** for statistics.

```{r trend-stats-fxs}
# table plot fx
trend.tbl.fx <- function(emt1, emt2, emt3, caption) {
  # bind into combined data frame
  emt.df <- bind_rows(lapply(
    list(emt1$emtrends, emt2$emtrends, emt3$emtrends),
    function(x) {
      data.frame(x)
    }), .id = "depth") %>%
    mutate(Depth = ifelse(depth == 1, "0-10cm", ifelse(depth == 2, "10-20cm", "20-30cm"))) %>%
    mutate(across(where(is.numeric), round, 1)) %>%
    mutate(year.trend = trendCIform.fx(year.trend, lower.CL, upper.CL)) %>%
    select(Depth, ECO, PM, year.trend, SE)
  # rearrange for printing
  emt.tbl <- split(emt.df, emt.df$Depth) %>% 
    reduce(right_join, by = c("ECO", "PM")) %>%
    select(-starts_with("Depth"))
  # print kable
  kable(emt.tbl,
        col.names = c(
          "Climate",
          "Parent material",
          "Trend",
          "$SE$",
          "Trend",
          "$SE$",
          "Trend",
          "$SE$"),
        escape = FALSE,    
        longtable = TRUE,
        booktabs = TRUE,
        caption = caption) %>%
    collapse_rows(1:2, latex_hline = "major", valign = "top") %>%
    add_header_above(c(" " = 2, "0-10cm" = 2, "10-20cm" = 2, "20-30cm" = 2)) %>%
    kable_classic(full_width = FALSE, html_font = "Cambria") %>%
    kable_styling(latex_options = c("repeat_header"),
                  font_size = 10)
}
```

(ref:blk-trend-stats-cap) Change in $\Delta$^14^C~*bulk*~, 2001-2019. Degrees of freedom = 44; confidence level used = 0.95.

```{r blk-trend-stats}
# run emtrends
emt.blk.PMeco.10 <- emtrends(blk.PMeco.10.lm, pairwise ~ PM | ECO, var = "year")
emt.blk.PMeco.20 <- emtrends(blk.PMeco.20.lm, pairwise ~ PM | ECO, var = "year")
emt.blk.PMeco.30 <- emtrends(blk.PMeco.30.lm, pairwise ~ PM | ECO, var = "year")

# print kable
trend.tbl.fx(emt.blk.PMeco.10, emt.blk.PMeco.20, emt.blk.PMeco.30, "(ref:blk-trend-stats-cap)")
```

(ref:inc-trend-stats-cap) Change in $\Delta$^14^C~*respired*~, 2001-2019. Degrees of freedom = 44; confidence level used = 0.95.

```{r inc-trend-stats}
# run emtrends
emt.inc.PMeco.10 <- emtrends(inc.PMeco.10.lm, pairwise ~ PM | ECO, var = "year")
emt.inc.PMeco.20 <- emtrends(inc.PMeco.20.lm, pairwise ~ PM | ECO, var = "year")
emt.inc.PMeco.30 <- emtrends(inc.PMeco.30.lm, pairwise ~ PM | ECO, var = "year")

# print kable
trend.tbl.fx(emt.inc.PMeco.10, emt.inc.PMeco.20, emt.inc.PMeco.30, "(ref:inc-trend-stats-cap)")
```

We saw more significant contrasts in the change over time in $\Delta$^14^C~*respired*~ than we did for $\Delta$^14^C~*bulk*~ (**Table \@ref(tab:blk-inc-trend-contrasts)**). When considered within climate zones, trends for the basaltic and granitic soils were more similar to one another overall than were either to the andesitic soils. We observed parent material trend contrasts more commonly in the cool and cold climate sites than in the warm sites; however we only observed significant trend contrasts for the cold climate sites in the $\Delta$^14^C~*respired*~ data, and not for $\Delta$^14^C~*bulk*~. When considered within parent materials, we saw more siginificant trend contrasts for the granitic and basaltic soils than for the andesitic soils (**Table \@ref(tab:blk-inc-trend-contrasts)**). 


```{r contrast-fxs}
# contrasts kable fx
# table plot fx
trdCts.tbl.fx <- function(emtPMeco.1, emtECOpm.1, 
                          emtPMeco.2, emtECOpm.2,
                          emtPMeco.3, emtECOpm.3, caption) {
  # bind into combined data frame
  emtC.df <- rapply(list(
  list(emtPMeco.1$contrasts, emtECOpm.1$contrasts),
  list(emtPMeco.2$contrasts, emtECOpm.2$contrasts),
  list(emtPMeco.3$contrasts, emtECOpm.3$contrasts)), function(x) {
    df <- sig.cts.fx(data.frame(x))
    names(df)[2] <- "Group"
    return(df)
  }, how = "list")
  names(emtC.df) <- c("0-10cm", "10-20cm", "20-30cm")
  
  # rearrange for printing
  return(
    bind_rows(emtC.df, .id = "id") %>%
      mutate(Depth = ifelse(id < 3, "0-10cm", ifelse(id < 5, "10-20cm", "20-30cm")),
             across(p.value, function(x) {
               case_when(!is.na(x) ~ pvalForm.fx(x))}),
             across(c(estimate, SE), ~ round(., 1))) %>%
      select(Depth, Group, contrast, estimate, SE, p.value))
}
```

(ref:blk-inc-trend-contrasts-cap) Contrasts for bulk and respired $\Delta$^14^C temporal trends. P value adjustment: Tukey method for comparing a family of 3 estimates.

```{r blk-inc-trend-contrasts}
# ecoPM contrasts
# bulk
emt.blk.ecoPM.10 <- emtrends(blk.PMeco.10.lm, pairwise ~ ECO | PM, var = "year")
emt.blk.ecoPM.20 <- emtrends(blk.PMeco.20.lm, pairwise ~ ECO | PM, var = "year")
emt.blk.ecoPM.30 <- emtrends(blk.PMeco.30.lm, pairwise ~ ECO | PM, var = "year")
# inc
emt.inc.ecoPM.10 <- emtrends(inc.PMeco.10.lm, pairwise ~ ECO | PM, var = "year")
emt.inc.ecoPM.20 <- emtrends(inc.PMeco.20.lm, pairwise ~ ECO | PM, var = "year")
emt.inc.ecoPM.30 <- emtrends(inc.PMeco.30.lm, pairwise ~ ECO | PM, var = "year")

# print kable
emt.cts.blk <- trdCts.tbl.fx(emt.blk.PMeco.10, emt.blk.ecoPM.10,
                             emt.blk.PMeco.20, emt.blk.ecoPM.20,
                             emt.blk.PMeco.30, emt.blk.ecoPM.30, "bulk contrasts")

emt.cts.inc <- trdCts.tbl.fx(emt.inc.PMeco.10, emt.inc.ecoPM.10, 
                             emt.inc.PMeco.20, emt.inc.ecoPM.20, 
                             emt.inc.PMeco.30, emt.inc.ecoPM.30, "inc contrasts")

# join
emt.cts <- merge(emt.cts.blk, emt.cts.inc, by = c("Depth", "Group", "contrast"), all = TRUE)

# set NA to blank
options(knitr.kable.NA = '')

# print kable
kable(emt.cts,
      col.names = c(
        "Depth",
        "Group",
        "Contrast",
        "Est.",
        "$SE$",
        "$p$",
        "Est.",
        "$SE$",
        "$p$"),
      escape = FALSE,    
      longtable = TRUE,
      booktabs = TRUE,
      caption = "(ref:blk-inc-contrasts-cap)") %>%
  collapse_rows(1, latex_hline = "major", valign = "top") %>%
  # row_spec(which(emt.cts$Group == "andesite" |
  #                  emt.cts$Group == "granite" |
  #                  emt.cts$Group == "basalt"), background = "gray") %>%
  add_header_above(c(" " = 3, "Bulk" = 3, "Respired" = 3)) %>%
  kable_classic(full_width = FALSE, html_font = "Cambria") %>%
  kable_styling(latex_options = "repeat_header",
                font_size = 10)
  # kable_styling(latex_options = c("repeat_header", "striped"),
  #               stripe_index = c(5:8, 15:18, 24:28),
  #               font_size = 10)
```

\clearpage

# Mineral assemblages

```{r load-min-14c-wtd-data}
# load data
load("sra.inc.30.min.conc.wtd.w.RData")
load("sra.blk.30.min.conc.wtd.w.RData")
load("sra.blk.inc.rep.min.30.df.RData")
```

```{r min-stats}
# pval fx
p.coef.fx <- function(lm, r, c) {
  p <- summary(lm)$coefficients[r, c]
  return(ifelse(p < .001, "<0.001", round(p, 3)))
}

# mods
## inc.blk
NonCrys.inc.blk.alo.mod <- lm(inc.blk ~ Al_ox + year, sra.blk.inc.rep.min.30.df[sra.blk.inc.rep.min.30.df$PMeco != "GRrf", ])
NonCrys.inc.blk.alp.mod <- lm(inc.blk ~ Al_py + year, sra.blk.inc.rep.min.30.df[sra.blk.inc.rep.min.30.df$PMeco != "GRrf", ])
NonCrys.inc.blk.feo.mod <- lm(inc.blk ~ Fe_ox + year, sra.blk.inc.rep.min.30.df[sra.blk.inc.rep.min.30.df$PMeco != "GRrf", ])
NonCrys.inc.blk.fed.mod <- lm(inc.blk ~ Fe_dc + year, sra.blk.inc.rep.min.30.df[sra.blk.inc.rep.min.30.df$PMeco != "GRrf", ])

# blk
NonCrys.blk.alo.mod <- lm(d14c_wtd_blk ~ Al_ox + year, sra.blk.inc.rep.min.30.df)
NonCrys.blk.alp.mod <- lm(d14c_wtd_blk ~ Al_py + year, sra.blk.inc.rep.min.30.df)
NonCrys.blk.feo.mod <- lm(d14c_wtd_blk ~ Fe_ox + year, sra.blk.inc.rep.min.30.df)
NonCrys.blk.fed.mod <- lm(d14c_wtd_blk ~ Fe_dc + year, sra.blk.inc.rep.min.30.df)

# inc
NonCrys.inc.alo.mod <- lm(d14c_wtd_inc ~ Al_ox + year, sra.blk.inc.rep.min.30.df[sra.blk.inc.rep.min.30.df$PMeco != "GRrf", ])
NonCrys.inc.alp.mod <- lm(d14c_wtd_inc ~ Al_py + year, sra.blk.inc.rep.min.30.df[sra.blk.inc.rep.min.30.df$PMeco != "GRrf", ])
NonCrys.inc.feo.mod <- lm(d14c_wtd_inc ~ Fe_ox + year, sra.blk.inc.rep.min.30.df[sra.blk.inc.rep.min.30.df$PMeco != "GRrf", ])
NonCrys.inc.fed.mod <- lm(d14c_wtd_inc ~ Fe_dc + year, sra.blk.inc.rep.min.30.df[sra.blk.inc.rep.min.30.df$PMeco != "GRrf", ])
```

We simplified the data in the main text to consider the relationship between $\Delta$^14^C and either poorly crystalline metal oxides or crystalline metal oxides. We present here the individual regression plots for $\Delta$^14^C~*bulk*~ (**Fig. \@ref(fig:min-blk30-plot)**) and $\Delta$^14^C~*respired*~ (**Fig. \@ref(fig:min-inc30-plot)**). 

We also present here the results of the individual regression analyses for $\Delta$^14^C~*bulk*~ (**Fig. \@ref(fig:min-all-blk-plot)**), $\Delta$^14^C~*respired*~ (**Fig. \@ref(fig:min-all-inc-plot)**), and $\Delta$^14^C~*respired-bulk*~ vs. Al selectively dissolved with ammonium oxalate (Al~o~) or sodium pyrophosphate (Al~p~), and Fe selectively dissolved with ammonium oxalate (Fe~o~), or dithionite citrate (Fe~d~) **Fig. \@ref(fig:min-all-inc-blk-plot)**. The relationships between Al~o~, Al~p~, and Fe~o~ and $\Delta$^14^C~*respired-bulk*~ in the models derived from Eq. (4) (main text) were all highly significant (*p* < 0.001). P-values for the metal oxide concentration coefficients in the $\Delta$^14^C~*respired-bulk*~ and $\Delta$^14^C~*bulk*~ models were highly significant (< 0.001 at $\alpha$ = 0.1) for Al~o~, Al~p~, and Fe~o~. The coefficient for Al~o~ in $\Delta$^14^C~*respired*~ model also had a p-value of < 0.001, but while still significant, p-values were larger for Al~p~ and Fe~o~ in the $\Delta$^14^C~*respired*~ models: `r paste(p.coef.fx(NonCrys.inc.alp.mod, 2, 4), p.coef.fx(NonCrys.inc.feo.mod, 2, 4), sep = ", ")`, respectively.
In contrast, the concentration of Fe~d~ was not significant in any of the models. 

```{r min-30-blk-inc-plot-setup}
# plot fx (for reps df)
blk.inc.min.30.plot.fx <- function(df, d14c_var, 
                                   min_in = NULL,
                                   min_smooth = TRUE,
                                   eco_in = NULL,
                                   eco_out = NULL,
                                   PMeco_filter = NULL,
                                   lg.pos) {
  
  # variables
  d14c_quo <- sym(d14c_var)
  
  # plot df
  plot.df <- df %>%
    pivot_longer(cols = which(names(df) %in% min_in), 
                 names_to = "min", values_to = "conc") %>%
    mutate(ECO = substr(PMeco, 3, 4),
           PM = substr(PMeco, 1, 2),
           min = factor(min, levels = min_in)) %>%
    mutate(eco = factor(ifelse(ECO == "pp", "warm",
                               ifelse(ECO == "wf", "cool", "cold")),
                        levels = c("warm", "cool", "cold")),
           pm = ifelse(PM == "AN", "andesite",
                       ifelse(PM == "BS", "basalt", "granite"))) %>%
    mutate(ecoYear = paste0(eco, " (", Year, ")"))
  
  # filter/select
  if (!is.null(eco_in)) {
    plot.df <- plot.df %>%
      filter(eco == eco_in)
  }
  if (!is.null(eco_out)) {
    plot.df <- plot.df %>%
      filter(eco != eco_out)
    }
  if (!is.null(PMeco_filter)) {
    plot.df <- plot.df %>%
      filter(PMeco != PMeco_filter)
  }
  
  # plot
  p <- ggplot(plot.df, aes(conc, !! d14c_quo)) +
    geom_point(aes(color = pm, shape = ecoYear), size = 2, alpha = .5) +
    scale_color_manual(name = NULL,
                       values = c("andesite" = andesite,
                                  "basalt" = basalt,
                                  "granite" = granite)) +
    scale_shape_manual(name = NULL,
                       limits = c("warm (2001)", 
                                  "cool (2001)", 
                                  "cold (2001)",
                                  "warm (2019)", 
                                  "cool (2019)", 
                                  "cold (2019)"),
                       values = c("warm (2001)" = 15, 
                                  "cool (2001)" = 17, 
                                  "cold (2001)" = 16,
                                  "warm (2019)" = 0, 
                                  "cool (2019)" = 2, 
                                  "cold (2019)" = 1)) +
    scale_linetype_manual(name = NULL,
                          values = c("2001" = 1, "2019" = 2)) +
    guides(linetype = guide_legend(override.aes = list(size = .5))) +
    scale_y_continuous(expand = expansion(mult = c(0, .15))) +
    theme_bw() +
    theme(panel.grid = element_blank(),
          axis.title = element_blank(),
          strip.background = element_blank(),
          strip.text = element_blank(),
          legend.position = lg.pos)
  
  # add geom_smooth
  if (min_smooth) {
    p +
      geom_smooth(data = filter(plot.df, min == min_in),
                  aes(conc, !! d14c_quo, linetype = Year),
                  method = "lm", formula = y ~ x, se = TRUE, 
                  color = "black", fill = "gray90")
  } else {
    p
  }
}
```

(ref:min-all-inc-blk-plot-cap) Relationship of selectively dissolved iron and alumnimum to the difference between $\Delta$^14^C~*respired*~ and $\Delta$^14^C~*bulk*~ ($\Delta$^14^C~*respired-bulk*~). (a) Oxalate-extractable aluminum (Al~o~),  (b) Pyrophosphate-extractable aluminum (Al~p~), (c) Oxalate-extractable iron (Fe~o~),  (d) Dithionite extractable iron (Fe~d~). Points show mass-weighted mineral concentrations and carbon-weighted values of $\Delta$^14^C~*respired-bulk*~ for 0-30cm profiles. Lines show linear model fits from Eq. (5) (main text).

```{r min-all-inc-blk-plot, fig.cap="(ref:min-all-inc-blk-plot-cap)"}
# make plot list
blk.min30.all.p.ls <- list(
  blk.inc.min.30.plot.fx(
    sra.blk.inc.rep.min.30.df[-which(sra.blk.inc.rep.min.30.df$PMeco == "GRrf"), ],
    d14c_var = "inc.blk",
    min_in = "Al_ox",
    lg.pos = "none"),
  blk.inc.min.30.plot.fx(
    sra.blk.inc.rep.min.30.df[-which(sra.blk.inc.rep.min.30.df$PMeco == "GRrf"), ],
    d14c_var = "inc.blk",
    min_in = "Al_py",
    lg.pos = "none") +
    theme(axis.text.y = element_text(color = "white")),
  blk.inc.min.30.plot.fx(
    sra.blk.inc.rep.min.30.df[-which(sra.blk.inc.rep.min.30.df$PMeco == "GRrf"), ],
    d14c_var = "inc.blk",
    min_in = "Fe_ox",
    lg.pos = "none"),
  blk.inc.min.30.plot.fx(
    sra.blk.inc.rep.min.30.df[-which(sra.blk.inc.rep.min.30.df$PMeco == "GRrf"), ],
    d14c_var = "inc.blk",
    min_in = "Fe_dc",
    lg.pos = "none") +
    theme(axis.text.y = element_text(color = "white")))

# common y axis label
x.grob <- textGrob(expression('Mineral concentration (g kg'^-2*')'),
                   gp = gpar(fontface = "bold", fontsize = 14))
y.grob <- textGrob(expression(Delta*''^14*'C'[italic(respired)]- Delta*''^14*'C'[italic(bulk)]*' (‰)'),
                   gp = gpar(fontface = "bold", fontsize = 14), rot = 90)

# add labels
mins <- c("'a) Al'[o]", "'b) Al'[p]", "'c) Fe'[o]", "'d) Fe'[d]")
pg <- arrangeGrob(
  plot_grid(plotlist = blk.min30.all.p.ls, nrow = 2, ncol = 2) +
    draw_plot_label(mins, x = c(.02, .52, .02, .52), y = c(1, 1, .5, .5), 
                    parse = TRUE),
  left = y.grob, bottom = x.grob)

# add legend
blk.30.lg <- get_legend(
  blk.min30.all.p.ls[[1]] +
    guides(linetype = guide_legend(override.aes = list(size = .5, fill = NA), 
                                   ncol = 1, order = 1),
           shape = guide_legend(override.aes = list(alpha = 1),
                                ncol = 2, order = 2),
           color = guide_legend(override.aes = list(alpha = 1),
                                ncol = 1, order = 3)) +
    theme(legend.position = "bottom")
)

# plot
plot_grid(pg, blk.30.lg, nrow = 2, rel_heights = c(1, .25))
```

(ref:min-all-blk-plot-cap) Relationship of selectively dissolved iron and alumnimum to $\Delta$^14^C~*bulk*~. (a) Oxalate-extractable aluminum (Al~o~),  (b) Pyrophosphate-extractable aluminum (Al~p~), (c) Oxalate-extractable iron (Fe~o~),  (d) Dithionite extractable iron (Fe~d~). Points show mass-weighted mineral concentrations and carbon-weighted values of $\Delta$^14^C~*bulk*~ for 0-30cm profiles. Lines show linear model fits from Eq. (5) (main text).

```{r min-all-blk-plot, fig.cap="(ref:min-all-blk-plot-cap)"}
# make plot list
blk.min30.all.p.ls <- list(
  blk.inc.min.30.plot.fx(
    sra.blk.inc.rep.min.30.df[-which(sra.blk.inc.rep.min.30.df$PMeco == "GRrf"), ],
    d14c_var = "d14c_wtd_blk",
    min_in = "Al_ox",
    lg.pos = "none"),
  blk.inc.min.30.plot.fx(
    sra.blk.inc.rep.min.30.df[-which(sra.blk.inc.rep.min.30.df$PMeco == "GRrf"), ],
    d14c_var = "d14c_wtd_blk",
    min_in = "Al_py",
    lg.pos = "none") +
    theme(axis.text.y = element_text(color = "white")),
  blk.inc.min.30.plot.fx(
    sra.blk.inc.rep.min.30.df[-which(sra.blk.inc.rep.min.30.df$PMeco == "GRrf"), ],
    d14c_var = "d14c_wtd_blk",
    min_in = "Fe_ox",
    lg.pos = "none"),
  blk.inc.min.30.plot.fx(
    sra.blk.inc.rep.min.30.df[-which(sra.blk.inc.rep.min.30.df$PMeco == "GRrf"), ],
    d14c_var = "d14c_wtd_blk",
    min_in = "Fe_dc",
    lg.pos = "none") +
    theme(axis.text.y = element_text(color = "white")))

# common y axis label
x.grob <- textGrob(expression('Mineral concentration (g kg'^-2*')'),
                   gp = gpar(fontface = "bold", fontsize = 14))
y.grob <- textGrob(expression(Delta*''^14*'C'[italic(bulk)]*' (‰)'),
                   gp = gpar(fontface = "bold", fontsize = 14), rot = 90)

# add labels
mins <- c("'a) Al'[o]", "'b) Al'[p]", "'c) Fe'[o]", "'d) Fe'[d]")
pg <- arrangeGrob(
  plot_grid(plotlist = blk.min30.all.p.ls, nrow = 2, ncol = 2) +
    draw_plot_label(mins, x = c(.02, .52, .02, .52), y = c(1, 1, .5, .5), 
                    parse = TRUE),
  left = y.grob, bottom = x.grob)

# add legend
blk.30.lg <- get_legend(
  blk.min30.all.p.ls[[1]] +
    guides(linetype = guide_legend(override.aes = list(size = .5, fill = NA), 
                                   ncol = 1, order = 1),
           shape = guide_legend(override.aes = list(alpha = 1),
                                ncol = 2, order = 2),
           color = guide_legend(override.aes = list(alpha = 1),
                                ncol = 1, order = 3)) +
    theme(legend.position = "bottom")
)

# plot
plot_grid(pg, blk.30.lg, nrow = 2, rel_heights = c(1, .25))
```

(ref:min-all-inc-plot-cap) Relationship of selectively dissolved iron and alumnimum to $\Delta$^14^C~*respired*~. (a) Oxalate-extractable aluminum (Al~o~),  (b) Pyrophosphate-extractable aluminum (Al~p~), (c) Oxalate-extractable iron (Fe~o~),  (d) Dithionite extractable iron (Fe~d~). Points show mass-weighted mineral concentrations and carbon-weighted values of $\Delta$^14^C~*respired*~ for 0-30cm profiles. Lines show linear model fits from Eq. (5) (main text).

```{r min-all-inc-plot, fig.cap="(ref:min-all-inc-plot-cap)"}
# make plot list
blk.min30.all.p.ls <- list(
  blk.inc.min.30.plot.fx(
    sra.blk.inc.rep.min.30.df[-which(sra.blk.inc.rep.min.30.df$PMeco == "GRrf"), ],
    d14c_var = "d14c_wtd_inc",
    min_in = "Al_ox",
    lg.pos = "none"),
  blk.inc.min.30.plot.fx(
    sra.blk.inc.rep.min.30.df[-which(sra.blk.inc.rep.min.30.df$PMeco == "GRrf"), ],
    d14c_var = "d14c_wtd_inc",
    min_in = "Al_py",
    lg.pos = "none") +
    theme(axis.text.y = element_text(color = "white")),
  blk.inc.min.30.plot.fx(
    sra.blk.inc.rep.min.30.df[-which(sra.blk.inc.rep.min.30.df$PMeco == "GRrf"), ],
    d14c_var = "d14c_wtd_inc",
    min_in = "Fe_ox",
    lg.pos = "none"),
  blk.inc.min.30.plot.fx(
    sra.blk.inc.rep.min.30.df[-which(sra.blk.inc.rep.min.30.df$PMeco == "GRrf"), ],
    d14c_var = "d14c_wtd_inc",
    min_in = "Fe_dc",
    lg.pos = "none") +
    theme(axis.text.y = element_text(color = "white")))

# common y axis label
x.grob <- textGrob(expression('Mineral concentration (g kg'^-2*')'),
                   gp = gpar(fontface = "bold", fontsize = 14))
y.grob <- textGrob(expression(Delta*''^14*'C'[italic(respired)]*' (‰)'),
                   gp = gpar(fontface = "bold", fontsize = 14), rot = 90)

# add labels
mins <- c("'a) Al'[o]", "'b) Al'[p]", "'c) Fe'[o]", "'d) Fe'[d]")
pg <- arrangeGrob(
  plot_grid(plotlist = blk.min30.all.p.ls, nrow = 2, ncol = 2) +
    draw_plot_label(mins, x = c(.02, .52, .02, .52), y = c(1, 1, .5, .5), 
                    parse = TRUE),
  left = y.grob, bottom = x.grob)

# add legend
blk.30.lg <- get_legend(
  blk.min30.all.p.ls[[1]] +
    guides(linetype = guide_legend(override.aes = list(size = .5, fill = NA), 
                                   ncol = 1, order = 1),
           shape = guide_legend(override.aes = list(alpha = 1),
                                ncol = 2, order = 2),
           color = guide_legend(override.aes = list(alpha = 1),
                                ncol = 1, order = 3)) +
    theme(legend.position = "bottom")
)

# plot
plot_grid(pg, blk.30.lg, nrow = 2, rel_heights = c(1, .25))
```

(ref:min-blk30-plot-cap) Relationship of poorly crystalline and crystalline minerals to $\Delta$^14^C~*bulk*~. (a) Poorly crystalline mineral content (oxalate-extractable aluminum + 1/2 oxalate-extractable iron), (b) Crystalline mineral content (dithionite-extractable iron - oxalate-extractable iron). Points show mass-weighted mineral concentrations and carbon-weighted values of $\Delta$^14^C~*bulk*~ for 0-30cm profiles. Lines show linear model fits from Eq. (5) (main text).

```{r min-blk30-plot, fig.cap="(ref:min-blk30-plot-cap)"}
# make plot list
blk.min30.p.ls <- list(
  blk.inc.min.30.plot.fx(
    sra.blk.inc.rep.min.30.df,
    d14c_var = "d14c_wtd_blk",
    min_in = "NonCrys",
    lg.pos = "none"),
  blk.inc.min.30.plot.fx(
    sra.blk.inc.rep.min.30.df,
    d14c_var = "d14c_wtd_blk",
    min_in = "Fe_cr",
    lg.pos = "none") +
  theme(axis.text.y = element_text(color = "white")))

# common y axis label
x.grob <- textGrob(expression('Mineral concentration (g kg'^-2*')'),
                   gp = gpar(fontface = "bold", fontsize = 14))
y.grob <- textGrob(expression(Delta*''^14*'C'[italic(bulk)]*' (‰)'),
                   gp = gpar(fontface = "bold", fontsize = 14), rot = 90)

# add labels
pg <- arrangeGrob(
  plot_grid(plotlist = blk.min30.p.ls, nrow = 1, ncol = 2) +
    draw_plot_label(label = c("a) poorly crystalline", "b) crystalline"), 
                    x = c(-.05, .54), y = 1),
  left = y.grob, bottom = x.grob)


# add legend
blk.30.lg <- get_legend(
  blk.min30.p.ls[[1]] +
    guides(linetype = guide_legend(override.aes = list(size = .5, fill = NA), 
                                   ncol = 1, order = 1),
           shape = guide_legend(override.aes = list(alpha = 1),
                                ncol = 2, order = 2),
           color = guide_legend(override.aes = list(alpha = 1),
                                ncol = 1, order = 3)) +
    theme(legend.position = "bottom")
)

# plot
plot_grid(pg, blk.30.lg, nrow = 2, rel_heights = c(1, .25))
```

(ref:min-inc30-plot-cap) Relationship of poorly crystalline and crystalline minerals to $\Delta$^14^C~*respired*~. (a) Poorly crystalline mineral content (oxalate-extractable aluminum + 1/2 oxalate-extractable iron), (b) Crystalline mineral content (dithionite-extractable iron - oxalate-extractable iron). Points show mass-weighted mineral concentrations and carbon-weighted values of $\Delta$^14^C~*respired*~ for 0-30cm profiles. Lines show linear model fits from Eq. (5) (main text).

```{r min-inc30-plot, fig.cap="(ref:min-inc30-plot-cap)"}
# make plot list
inc.min30.p.ls <- list(
  blk.inc.min.30.plot.fx(
    sra.blk.inc.rep.min.30.df[-which(sra.blk.inc.rep.min.30.df$PMeco == "GRrf"), ],
    d14c_var = "d14c_wtd_inc",
    min_in = "NonCrys",
    lg.pos = "none"),
  blk.inc.min.30.plot.fx(
    sra.blk.inc.rep.min.30.df[-which(sra.blk.inc.rep.min.30.df$PMeco == "GRrf"), ],
    d14c_var = "d14c_wtd_inc",
    min_in = "Fe_cr",
    lg.pos = "none") +
  theme(axis.text.y = element_text(color = "white")))

# common y axis label
x.grob <- textGrob(expression('Mineral concentration (g kg'^-2*')'),
                   gp = gpar(fontface = "bold", fontsize = 14))
y.grob <- textGrob(expression(Delta*''^14*'C'[italic(respired)]*' (‰)'),
                   gp = gpar(fontface = "bold", fontsize = 14), rot = 90)

# add labels
pg <- arrangeGrob(
  plot_grid(plotlist = inc.min30.p.ls, nrow = 1, ncol = 2) +
    draw_plot_label(label = c("a) poorly crystalline", "b) crystalline"), 
                    x = c(-.05, .54), y = 1),
  left = y.grob, bottom = x.grob)

# add legend
inc.30.lg <- get_legend(
  inc.min30.p.ls[[1]] +
    guides(linetype = guide_legend(override.aes = list(size = .5, fill = NA), 
                                   ncol = 1, order = 1),
           shape = guide_legend(override.aes = list(alpha = 1),
                                ncol = 2, order = 2),
           color = guide_legend(override.aes = list(alpha = 1),
                                ncol = 1, order = 3)) +
    theme(legend.position = "bottom")
)

# plot
plot_grid(pg, inc.30.lg, nrow = 2, rel_heights = c(1, .25))
```